<link rel="stylesheet" href="/css/user/mypage.css" th:href="@{/css/user/mypage.css}">
<link rel="stylesheet" href="/css/sideBar.css" th:href="@{/css/sideBar.css}">

<th:block th:replace="~{include/include :: def(~{::section})}">


    <section id="wrap">
        <th:block th:replace="~{include/side :: def(~{::#wrap})}"/>

        <!-- ìƒë‹¨ë‹¨ -->
        <div class="section_right">
            <h1>[[${user.nickname}]]ë‹˜ ì•ˆë…•í•˜ì„¸ìš”</h1>
            <div class="profile-section">
                <div class="profile-left">
                    <img class="profile-img" th:src="${user.imgUrl}" alt="">
                </div>
<!--                <div class="profile-info">-->
<!--                    <div class="level">LV.5 ê³ ëª©ë‚˜ë¬´</div>-->
<!--                    <div class="tree-icon">ğŸŒ³</div>-->
<!--                    <div>ë§¤ë„ˆë“±ê¸‰</div>-->
<!--                    <div class="manners-bar">-->
<!--                        <div class="progress"></div>-->
<!--                    </div>-->
<!--                    <div class="manners-labels">-->
<!--                        <span>LV.5</span>-->
<!--                        <span>LV.6</span>-->
<!--                    </div>-->
<!--                </div>-->
                <div class="stat-item">
                    <div class="label">êµ¬ë§¤ìˆ˜</div>
                    <div class="value">[[${buycount}]]</div>
                </div>
                <div class="stat-item">
                    <div class="label">íŒë§¤ìˆ˜</div>
                    <div class="value">[[${sellcount}]]</div>
                </div>
                <div class="stat-item">
                    <div class="label">ë¦¬ë·°</div>
                    <div class="value">[[${review}]]</div>
                </div>
            </div>

            <!-- ì¤‘ê°„ -->
            <div>
                <h2>ìµœê·¼ ì£¼ë¬¸ ìƒí’ˆ</h2>
                <div style="display: flex; gap: 20px;">
                    <div th:each="list : ${orderprod}">
                        <a th:href="'/prod/prodDetail?prodId='+${list.prodId}" class="latest-order">
                            <div class="latest-order">
                                <div class="media-container">
                                    <img th:src="${list.img1}" alt="" class="main-img">
                                    <!-- ë¹„ë””ì˜¤ ìš”ì†Œ ì¶”ê°€ (ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€) -->
                                    <video class="prod-video" th:if="${list.videoUrl != null}"
                                           th:data-src="${list.videoUrl}" muted preload="none"></video>
                                </div>
                                <div class="title">[[${list.title}]]</div>
                                <h4>[[${#numbers.formatInteger(list.price, 0, 'COMMA')}]]ì›</h4>
                                <div class="address">[[${list.pickupAddress != null ? (
                                    #strings.contains(list.pickupAddress, 'íŠ¹ë³„ìì¹˜') ?
                                    #strings.substring(#strings.substringAfter(list.pickupAddress, '/'), 0, 11) :
                                    #strings.substring(#strings.substringAfter(list.pickupAddress, '/'), 0, 6)
                                    ) : ''}]]
                                    [[${#temporals.format(list.regDate, 'yyë…„MMì›”ddì¼')}]] ë“±ë¡
                                </div>
                            </div>
                        </a>
                    </div>
                    <a href="/prod/orderList" class="next-btn">
                        <img src="/img/user/Vector.png" alt="" style="width: 50px; height: 50px;">
                    </a>
                </div>
            </div>

            <!-- í•˜ë‹¨ -->
            <div style="margin: 100px 0 100px 0;">
                <h2>ìµœê·¼ íŒë§¤ ìƒí’ˆ</h2>
                <div style="display: flex; gap: 20px;">
                    <div th:each="list : ${sellprod}">
                        <a th:href="'/prod/prodDetail?prodId='+${list.prodId}" class="latest-order">
                            <div class="latest-order">
                                <div class="media-container">
                                    <img th:src="${list.img1}" alt="" class="main-img">
                                    <!-- ë¹„ë””ì˜¤ ìš”ì†Œ ì¶”ê°€ (ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€) -->
                                    <video class="prod-video" th:if="${list.videoUrl != null}"
                                           th:data-src="${list.videoUrl}" muted preload="none"></video>
                                </div>
                                <div class="title">[[${list.title}]]</div>
                                <h4>[[${#numbers.formatInteger(list.price, 0, 'COMMA')}]]ì›</h4>
                                <div class="address">
                                    <!--ì£¼ì†Œ ìª¼ê°œì„œ ë³´ì—¬ì£¼ê¸°-->
                                    [[${list.pickupAddress != null ? (
                                    #strings.contains(list.pickupAddress, 'íŠ¹ë³„ìì¹˜') ?
                                    #strings.substring(#strings.substringAfter(list.pickupAddress, '/'), 0, 11) :
                                    #strings.substring(#strings.substringAfter(list.pickupAddress, '/'), 0, 6)
                                    ) : ''}]]
                                    [[${#temporals.format(list.regDate, 'yyë…„MMì›”ddì¼')}]] ë“±ë¡
                                </div>
                            </div>
                        </a>
                    </div>
                    <a href="/prod/myProdList" class="next-btn">
                        <img src="/img/user/Vector.png" alt="" style="width: 50px; height: 50px;">
                    </a>
                </div>
            </div>

        </div>

    </section>

</th:block>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // ëª¨ë“  ë¯¸ë””ì–´ ì»¨í…Œì´ë„ˆì— ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        const mediaContainers = document.querySelectorAll('.media-container');

        mediaContainers.forEach(container => {
            const video = container.querySelector('.prod-video');
            const image = container.querySelector('.main-img');

            if (video) {
                // ë§ˆìš°ìŠ¤ê°€ ì»¨í…Œì´ë„ˆ ìœ„ë¡œ ì˜¬ë¼ê°ˆ ë•Œ
                container.addEventListener('mouseenter', () => {
                    const videoSrc = video.getAttribute('data-src');
                    if (videoSrc) {
                        video.src = videoSrc;
                        video.style.display = 'block';
                        image.style.display = 'none';
                        video.play();
                    }
                });

                // ë§ˆìš°ìŠ¤ê°€ ì»¨í…Œì´ë„ˆì—ì„œ ë²—ì–´ë‚  ë•Œ
                container.addEventListener('mouseleave', () => {
                    video.pause();
                    video.style.display = 'none';
                    image.style.display = 'block';
                    video.removeAttribute('src'); // ë©”ëª¨ë¦¬ ê´€ë¦¬ë¥¼ ìœ„í•´ ì†ŒìŠ¤ ì œê±°
                    video.load();
                });
            }
        });
    });
</script>
<script th:if="${msg}" th:inline="javascript">
  var messageText = "${msg}" // msg ê°’ì„ JS ë³€ìˆ˜ì— ë¨¼ì € ì €ì¥
  alert(messageText);          // ì €ì¥ëœ ë³€ìˆ˜ë¥¼ alert ì— ì‚¬ìš©
</script>
<script src="../js/sideBar.js" th:src="@{/js/sideBar.js}"></script>